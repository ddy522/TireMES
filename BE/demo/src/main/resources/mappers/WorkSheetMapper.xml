<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.demo.mapper.WorkSheetMapper">

    <!-- 컬럼명(snake_case) ↔ DTO 필드(camelCase) 명시 매핑 -->
    <resultMap id="WorkSheetMap" type="com.example.demo.model.WorkSheetModel">
        <result column="work_no"     property="workNo"/>
        <result column="deadline"    property="deadline"/>
        <result column="priority"    property="priority"/>
        <result column="part_code"   property="partCode"/>
        <result column="process_code" property="processCode"/>
        <result column="qty"         property="qty"/>
        <result column="work_state"  property="workStatus"/>
        <result column="part_name"   property="partName"/>
        <result column="process_name_eng"  property="processNameEng"/>
    </resultMap>

    <!--전체 작업지시 조회 -->
    <select id="findAllWorkList" resultMap="WorkSheetMap">
        SELECT
        w.work_no,
        w.deadline,
        w.priority,
        w.part_code,
        w.process_code,
        w.qty,
        w.work_state,
        p.part_name
        FROM worksheet w
        LEFT JOIN part p
        ON w.part_code = p.part_code
    </select>

    <!--공정별 작업지시 조회  : process_name_eng 받아서 -->
    <select id="findByProcessNameEng" parameterType = "string" resultMap="WorkSheetMap">
        SELECT
        w.work_no,
        w.deadline,
        w.priority,
        w.part_code,
        w.process_code,
        w.qty,
        w.work_state,
        p.part_name,
        pr.process_name_eng
        FROM worksheet w
        LEFT JOIN part p
        ON w.part_code = p.part_code
        LEFT JOIN `process` pr
        ON w.process_code = pr.process_no
        WHERE pr.process_name_eng = #{processNameEng}
    </select>



</mapper>
