<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.demo.mapper.InventoryLotTraceMapper">

    <resultMap id="LotTraceMap" type="com.example.demo.model.InventoryLotTraceModel">
        <result column="lotno"         property="lotNo"/>
        <result column="created_at"    property="createdAt"/>
        <result column="qty"           property="qty"/>
    </resultMap>

    <select id="findLotsByPartCode" parameterType="string" resultMap="LotTraceMap">
        <![CDATA[
      SELECT
          l.lotno,
          DATE_FORMAT(l.created_at, '%Y-%m-%d %H:%i')  AS created_at,
          l.qty
      FROM lot l
      WHERE l.part_code = #{partCode}
      ORDER BY l.created_at DESC, l.lotno DESC
    ]]>
    </select>

</mapper>
